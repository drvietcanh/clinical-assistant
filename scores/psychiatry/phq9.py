"""
PHQ-9 - Patient Health Questionnaire-9
S√†ng l·ªçc v√† ƒë√°nh gi√° m·ª©c ƒë·ªô tr·∫ßm c·∫£m
"""

import streamlit as st


# PHQ-9 questions in Vietnamese
PHQ9_QUESTIONS = [
    "√çt quan t√¢m ho·∫∑c √≠t th√≠ch th√∫ l√†m vi·ªác",
    "C·∫£m th·∫•y bu·ªìn, ch√°n n·∫£n ho·∫∑c tuy·ªát v·ªçng",
    "Kh√≥ ng·ªß, ng·ªß kh√¥ng say gi·∫•c ho·∫∑c ng·ªß qu√° nhi·ªÅu",
    "C·∫£m th·∫•y m·ªát m·ªèi ho·∫∑c kh√¥ng c√≥ nƒÉng l∆∞·ª£ng",
    "√çt th√®m ƒÉn ho·∫∑c ƒÉn qu√° nhi·ªÅu",
    "C·∫£m th·∫•y t·ªìi t·ªá v·ªÅ b·∫£n th√¢n - ho·∫∑c c·∫£m th·∫•y m√¨nh l√† ng∆∞·ªùi th·∫•t b·∫°i ho·∫∑c ƒë√£ l√†m gia ƒë√¨nh hay ch√≠nh b·∫£n th√¢n th·∫•t v·ªçng",
    "Kh√≥ t·∫≠p trung v√†o vi·ªác g√¨ ƒë√≥, ch·∫≥ng h·∫°n nh∆∞ ƒë·ªçc b√°o ho·∫∑c xem TV",
    "Di chuy·ªÉn ho·∫∑c n√≥i chuy·ªán ch·∫≠m ch·∫°p ƒë·∫øn m·ª©c ng∆∞·ªùi kh√°c c√≥ th·ªÉ nh·∫≠n ra. Ho·∫∑c ng∆∞·ª£c l·∫°i - b·ªìn ch·ªìn ho·∫∑c kh√¥ng y√™n ƒë·∫øn m·ª©c di chuy·ªÉn nhi·ªÅu h∆°n b√¨nh th∆∞·ªùng",
    "Nghƒ© r·∫±ng t·ªët h∆°n l√† ch·∫øt ƒëi ho·∫∑c t·ª± l√†m h·∫°i b·∫£n th√¢n theo m·ªôt c√°ch n√†o ƒë√≥"
]


def calculate_phq9(scores):
    """
    Calculate total PHQ-9 score
    
    Args:
        scores: List of 9 scores (0-3 for each question)
    
    Returns:
        int: Total score (0-27)
    """
    return sum(scores)


def interpret_phq9(total_score):
    """
    Interpret PHQ-9 score
    
    Args:
        total_score: Total PHQ-9 score
    
    Returns:
        dict: Interpretation results
    """
    if total_score < 5:
        return {
            "severity": "Kh√¥ng c√≥ / T·ªëi thi·ªÉu",
            "color": "üü¢",
            "description": "Kh√¥ng c√≥ tri·ªáu ch·ª©ng tr·∫ßm c·∫£m ƒë√°ng k·ªÉ",
            "recommendation": "Kh√¥ng c·∫ßn can thi·ªáp. T√°i ƒë√°nh gi√° khi c·∫ßn thi·∫øt.",
            "monitoring": "Theo d√µi th∆∞·ªùng xuy√™n n·∫øu c√≥ y·∫øu t·ªë nguy c∆°",
            "level": "none"
        }
    elif total_score < 10:
        return {
            "severity": "Tr·∫ßm c·∫£m nh·∫π",
            "color": "üü°",
            "description": "C√≥ m·ªôt s·ªë tri·ªáu ch·ª©ng tr·∫ßm c·∫£m",
            "recommendation": "H·ªó tr·ª£, watchful waiting. Gi√°o d·ª•c b·ªánh nh√¢n, v·ªá sinh gi·∫•c ng·ªß, t·∫≠p th·ªÉ d·ª•c.",
            "monitoring": "T√°i ƒë√°nh gi√° sau 4-6 tu·∫ßn. Xem x√©t can thi·ªáp n·∫øu kh√¥ng c·∫£i thi·ªán.",
            "level": "mild"
        }
    elif total_score < 15:
        return {
            "severity": "Tr·∫ßm c·∫£m m·ª©c trung b√¨nh",
            "color": "üü†",
            "description": "Tr·∫ßm c·∫£m ·∫£nh h∆∞·ªüng ƒë·∫øn ch·ª©c nƒÉng h√†ng ng√†y",
            "recommendation": "Xem x√©t ƒëi·ªÅu tr·ªã: T√¢m l√Ω tr·ªã li·ªáu (CBT) ho·∫∑c thu·ªëc ch·ªëng tr·∫ßm c·∫£m (SSRI).",
            "monitoring": "T√°i ƒë√°nh gi√° sau 2-4 tu·∫ßn. Theo d√µi s√°t ƒë√°p ·ª©ng ƒëi·ªÅu tr·ªã.",
            "level": "moderate"
        }
    elif total_score < 20:
        return {
            "severity": "Tr·∫ßm c·∫£m m·ª©c trung b√¨nh n·∫∑ng",
            "color": "üü†",
            "description": "Tr·∫ßm c·∫£m ·∫£nh h∆∞·ªüng nghi√™m tr·ªçng ƒë·∫øn ch·ª©c nƒÉng",
            "recommendation": "ƒêi·ªÅu tr·ªã t√≠ch c·ª±c: K·∫øt h·ª£p t√¢m l√Ω tr·ªã li·ªáu V√Ä thu·ªëc ch·ªëng tr·∫ßm c·∫£m.",
            "monitoring": "Theo d√µi s√°t, t√°i ƒë√°nh gi√° m·ªói 1-2 tu·∫ßn. C√¢n nh·∫Øc h·ªôi ch·∫©n t√¢m th·∫ßn.",
            "level": "moderate_severe"
        }
    else:
        return {
            "severity": "Tr·∫ßm c·∫£m n·∫∑ng",
            "color": "üî¥",
            "description": "Tr·∫ßm c·∫£m r·∫•t n·∫∑ng, c√≥ th·ªÉ c·∫ßn can thi·ªáp kh·∫©n c·∫•p",
            "recommendation": "ƒêi·ªÅu tr·ªã t√≠ch c·ª±c: Thu·ªëc + T√¢m l√Ω tr·ªã li·ªáu. Chuy·ªÉn t·ªõi chuy√™n khoa t√¢m th·∫ßn. Xem x√©t nh·∫≠p vi·ªán n·∫øu c√≥ √Ω t∆∞·ªüng t·ª± t·ª≠.",
            "monitoring": "Theo d√µi r·∫•t s√°t (h√†ng tu·∫ßn). ƒê√°nh gi√° nguy c∆° t·ª± t·ª≠. Li√™n l·∫°c v·ªõi chuy√™n khoa t√¢m th·∫ßn.",
            "level": "severe"
        }


def assess_suicide_risk(question_9_score):
    """
    Assess suicide risk based on question 9
    
    Args:
        question_9_score: Score for question 9 (0-3)
    
    Returns:
        dict: Suicide risk assessment
    """
    if question_9_score == 0:
        return {
            "risk": "Kh√¥ng c√≥",
            "color": "üü¢",
            "action": "Kh√¥ng c·∫ßn can thi·ªáp ƒë·∫∑c bi·ªát v·ªÅ v·∫•n ƒë·ªÅ n√†y"
        }
    elif question_9_score == 1:
        return {
            "risk": "C√≥ √Ω nghƒ© (v√†i ng√†y)",
            "color": "üü°",
            "action": "ƒê√°nh gi√° th√™m. H·ªèi v·ªÅ k·∫ø ho·∫°ch, ph∆∞∆°ng ti·ªán. TƒÉng c∆∞·ªùng h·ªó tr·ª£."
        }
    elif question_9_score == 2:
        return {
            "risk": "C√≥ √Ω nghƒ© (h∆°n n·ª≠a s·ªë ng√†y)",
            "color": "üü†",
            "action": "ƒê√°nh gi√° chi ti·∫øt nguy c∆° t·ª± t·ª≠. Xem x√©t an to√†n. H·ªôi ch·∫©n t√¢m th·∫ßn kh·∫©n."
        }
    else:  # score == 3
        return {
            "risk": "C√≥ √Ω nghƒ© (g·∫ßn nh∆∞ m·ªói ng√†y)",
            "color": "üî¥",
            "action": "C·∫§P C·ª®U: ƒê√°nh gi√° ngay nguy c∆° t·ª± t·ª≠. Kh√¥ng ƒë·ªÉ b·ªánh nh√¢n m·ªôt m√¨nh. Chuy·ªÉn t·ªõi c∆° s·ªü t√¢m th·∫ßn ho·∫∑c c·∫•p c·ª©u."
        }


def render():
    """Render the PHQ-9 calculator"""
    
    st.title("üß† PHQ-9 - Patient Health Questionnaire")
    st.markdown("""
    ### S√†ng L·ªçc & ƒê√°nh Gi√° Tr·∫ßm C·∫£m
    
    **PHQ-9:**
    - C√¥ng c·ª• s√†ng l·ªçc tr·∫ßm c·∫£m ƒë∆∞·ª£c validate r·ªông r√£i
    - 9 c√¢u h·ªèi d·ª±a tr√™n ti√™u ch√≠ DSM-5
    - ƒê√°nh gi√° tri·ªáu ch·ª©ng trong 2 tu·∫ßn qua
    - S·ª≠ d·ª•ng cho screening, ch·∫©n ƒëo√°n, v√† theo d√µi ƒëi·ªÅu tr·ªã
    
    **H∆∞·ªõng d·∫´n:**
    - ƒê√°nh gi√° t·ª´ng tri·ªáu ch·ª©ng d·ª±a tr√™n t·∫ßn su·∫•t xu·∫•t hi·ªán
    - Thang ƒëi·ªÉm: 0 (Kh√¥ng c√≥) ‚Üí 3 (G·∫ßn nh∆∞ m·ªói ng√†y)
    - T·ªïng ƒëi·ªÉm: 0-27
    
    **·ª®ng d·ª•ng:**
    - Primary care screening
    - Theo d√µi ƒë√°p ·ª©ng ƒëi·ªÅu tr·ªã
    - ƒêi·ªÅu ch·ªânh li·ªÅu thu·ªëc
    - ƒê√°nh gi√° t√°i ph√°t
    """)
    
    st.markdown("---")
    
    # Instructions
    st.info("""
    **Trong 2 tu·∫ßn qua**, b·∫°n b·ªã l√†m phi·ªÅn bao nhi√™u l·∫ßn b·ªüi c√°c v·∫•n ƒë·ªÅ sau?
    
    Ch·ªçn ƒë√°p √°n ph√π h·ª£p nh·∫•t:
    - **0** = Kh√¥ng c√≥
    - **1** = V√†i ng√†y
    - **2** = H∆°n n·ª≠a s·ªë ng√†y
    - **3** = G·∫ßn nh∆∞ m·ªói ng√†y
    """)
    
    st.markdown("---")
    
    # Questions
    st.subheader("üìã B·∫£ng C√¢u H·ªèi")
    
    scores = []
    
    for i, question in enumerate(PHQ9_QUESTIONS, 1):
        st.markdown(f"**{i}. {question}**")
        
        score = st.radio(
            "Ch·ªçn m·ª©c ƒë·ªô:",
            options=[0, 1, 2, 3],
            format_func=lambda x: ["0 - Kh√¥ng c√≥", "1 - V√†i ng√†y", "2 - H∆°n n·ª≠a s·ªë ng√†y", "3 - G·∫ßn nh∆∞ m·ªói ng√†y"][x],
            key=f"phq9_q{i}",
            horizontal=True
        )
        scores.append(score)
        
        # Special warning for question 9 (suicide)
        if i == 9 and score > 0:
            st.warning("‚ö†Ô∏è **Quan tr·ªçng:** C√≥ √Ω nghƒ© t·ª± t·ª≠ - c·∫ßn ƒë√°nh gi√° ngay!")
        
        st.markdown("---")
    
    # Calculate button
    if st.button("üìä T√≠nh ƒêi·ªÉm & Ph√¢n T√≠ch", type="primary", use_container_width=True):
        # Calculate total score
        total_score = calculate_phq9(scores)
        
        # Get interpretation
        result = interpret_phq9(total_score)
        
        # Get suicide risk
        suicide_risk = assess_suicide_risk(scores[8])  # Question 9
        
        st.markdown("---")
        st.subheader("üìà K·∫øt Qu·∫£ ƒê√°nh Gi√°")
        
        # Display total score
        col1, col2 = st.columns([1, 2])
        
        with col1:
            st.metric(
                "T·ªïng ƒêi·ªÉm PHQ-9",
                f"{total_score}/27",
                help="T·ªïng ƒëi·ªÉm t·ª´ 9 c√¢u h·ªèi"
            )
        
        with col2:
            if result['level'] == "none":
                st.success(f"{result['color']} **{result['severity']}**")
            elif result['level'] in ["mild", "moderate"]:
                st.warning(f"{result['color']} **{result['severity']}**")
            else:
                st.error(f"{result['color']} **{result['severity']}**")
        
        st.markdown("---")
        
        # Detailed interpretation
        st.subheader("üéØ Ph√¢n T√≠ch Chi Ti·∫øt")
        
        st.info(f"""
        **M·ª©c ƒë·ªô:** {result['severity']} (ƒêi·ªÉm: {total_score})
        
        **M√¥ t·∫£:** {result['description']}
        
        **Khuy·∫øn ngh·ªã ƒëi·ªÅu tr·ªã:** {result['recommendation']}
        
        **Theo d√µi:** {result['monitoring']}
        """)
        
        # Suicide risk assessment
        if scores[8] > 0:
            st.markdown("---")
            st.subheader("‚ö†Ô∏è ƒê√°nh Gi√° Nguy C∆° T·ª± T·ª≠")
            
            if suicide_risk['color'] == "üî¥":
                st.error(f"""
                {suicide_risk['color']} **Nguy c∆°: {suicide_risk['risk']}**
                
                **H√†nh ƒë·ªông:** {suicide_risk['action']}
                
                **ƒê√°nh gi√° b·ªï sung:**
                - C√≥ k·∫ø ho·∫°ch c·ª• th·ªÉ kh√¥ng?
                - C√≥ ph∆∞∆°ng ti·ªán kh√¥ng?
                - Ti·ªÅn s·ª≠ t·ª± t·ª≠ tr∆∞·ªõc ƒë√¢y?
                - C√≥ h·ªó tr·ª£ x√£ h·ªôi kh√¥ng?
                - C√≥ s·ª≠ d·ª•ng ch·∫•t k√≠ch th√≠ch kh√¥ng?
                
                **Li√™n h·ªá ngay:**
                - ƒê∆∞·ªùng d√¢y n√≥ng t√¢m l√Ω: 1900 0115
                - C·∫•p c·ª©u: 115
                - Chuy·ªÉn khoa t√¢m th·∫ßn kh·∫©n c·∫•p
                """)
            else:
                st.warning(f"""
                {suicide_risk['color']} **Nguy c∆°: {suicide_risk['risk']}**
                
                **H√†nh ƒë·ªông:** {suicide_risk['action']}
                """)
        
        # Score breakdown
        st.markdown("---")
        st.subheader("üìä Ph√¢n T√≠ch T·ª´ng C√¢u H·ªèi")
        
        # Create a chart
        symptom_labels = [
            "1. M·∫•t h·ª©ng th√∫",
            "2. Bu·ªìn/ch√°n n·∫£n",
            "3. R·ªëi lo·∫°n gi·∫•c ng·ªß",
            "4. M·ªát m·ªèi",
            "5. Thay ƒë·ªïi ƒÉn u·ªëng",
            "6. C·∫£m gi√°c t·ªôi l·ªói",
            "7. Kh√≥ t·∫≠p trung",
            "8. Ch·∫≠m ch·∫°p/b·ªìn ch·ªìn",
            "9. √ù nghƒ© t·ª± t·ª≠"
        ]
        
        for i, (label, score) in enumerate(zip(symptom_labels, scores)):
            col1, col2 = st.columns([3, 1])
            with col1:
                st.write(label)
            with col2:
                bar_length = score * 25  # 25% per point
                if score == 0:
                    st.write("üü¢ 0")
                elif score == 1:
                    st.write("üü° 1")
                elif score == 2:
                    st.write("üü† 2")
                else:
                    st.write("üî¥ 3")
        
        # Functional impairment
        st.markdown("---")
        st.subheader("üîç ƒê√°nh Gi√° Ch·ª©c NƒÉng")
        
        functional_impact = st.radio(
            "**C√°c v·∫•n ƒë·ªÅ tr√™n ƒë√£ ·∫£nh h∆∞·ªüng ƒë·∫øn c√¥ng vi·ªác, vi·ªác nh√†, ho·∫∑c quan h·ªá v·ªõi ng∆∞·ªùi kh√°c c·ªßa b·∫°n ƒë·∫øn m·ª©c ƒë·ªô n√†o?**",
            [
                "Kh√¥ng kh√≥ khƒÉn",
                "H∆°i kh√≥ khƒÉn",
                "R·∫•t kh√≥ khƒÉn",
                "C·ª±c k·ª≥ kh√≥ khƒÉn"
            ],
            help="C√¢u h·ªèi b·ªï sung ƒë√°nh gi√° ·∫£nh h∆∞·ªüng ch·ª©c nƒÉng (kh√¥ng t√≠nh ƒëi·ªÉm)"
        )
        
        if functional_impact != "Kh√¥ng kh√≥ khƒÉn":
            st.warning(f"""
            ‚ö†Ô∏è **·∫¢nh h∆∞·ªüng ch·ª©c nƒÉng:** {functional_impact}
            
            ƒêi·ªÅu n√†y cho th·∫•y c√°c tri·ªáu ch·ª©ng tr·∫ßm c·∫£m ƒëang ·∫£nh h∆∞·ªüng ƒë√°ng k·ªÉ ƒë·∫øn cu·ªôc s·ªëng h√†ng ng√†y.
            Can thi·ªáp ƒëi·ªÅu tr·ªã ƒë∆∞·ª£c khuy·∫øn ngh·ªã m·∫°nh m·∫Ω h∆°n.
            """)
    
    # Educational content
    st.markdown("---")
    st.subheader("üìö Th√¥ng Tin B·ªï Sung")
    
    with st.expander("üìã Ph√¢n Lo·∫°i M·ª©c ƒê·ªô Tr·∫ßm C·∫£m"):
        st.markdown("""
        ### Ph√¢n lo·∫°i theo ƒëi·ªÉm PHQ-9:
        
        | ƒêi·ªÉm | M·ª©c ƒë·ªô | Khuy·∫øn ngh·ªã |
        |------|--------|-------------|
        | 0-4 | Kh√¥ng c√≥ / T·ªëi thi·ªÉu | Kh√¥ng c·∫ßn can thi·ªáp |
        | 5-9 | Nh·∫π | H·ªó tr·ª£, watchful waiting |
        | 10-14 | Trung b√¨nh | CBT ho·∫∑c thu·ªëc |
        | 15-19 | Trung b√¨nh n·∫∑ng | CBT + thu·ªëc |
        | 20-27 | N·∫∑ng | ƒêi·ªÅu tr·ªã t√≠ch c·ª±c, chuy√™n khoa |
        
        **L∆∞u √Ω:**
        - PHQ-9 ‚â• 10 c√≥ ƒë·ªô nh·∫°y 88% v√† ƒë·ªô ƒë·∫∑c hi·ªáu 88% cho major depression
        - C·∫ßn ƒë√°nh gi√° l√¢m s√†ng to√†n di·ªán, kh√¥ng ch·ªâ d·ª±a v√†o ƒëi·ªÉm s·ªë
        - Xem x√©t c√°c ch·∫©n ƒëo√°n ph√¢n bi·ªát (r·ªëi lo·∫°n l∆∞·ª°ng c·ª±c, lo √¢u, v.v.)
        """)
    
    with st.expander("üíä L·ª±a Ch·ªçn ƒêi·ªÅu Tr·ªã"):
        st.markdown("""
        ### T√¢m l√Ω tr·ªã li·ªáu:
        
        **Cognitive Behavioral Therapy (CBT):**
        - Hi·ªáu qu·∫£ t∆∞∆°ng ƒë∆∞∆°ng thu·ªëc cho tr·∫ßm c·∫£m nh·∫π-trung b√¨nh
        - L·ª±a ch·ªçn ƒë·∫ßu tay cho tr·∫ßm c·∫£m nh·∫π
        - K√©o d√†i 12-16 bu·ªïi
        - T·ª∑ l·ªá t√°i ph√°t th·∫•p h∆°n
        
        **C√°c ph∆∞∆°ng ph√°p kh√°c:**
        - Interpersonal therapy (IPT)
        - Problem-solving therapy
        - Mindfulness-based therapy
        - Behavioral activation
        
        ### Thu·ªëc ch·ªëng tr·∫ßm c·∫£m:
        
        **SSRI (L·ª±a ch·ªçn ƒë·∫ßu tay):**
        - Sertraline 50-200 mg/ng√†y
        - Escitalopram 10-20 mg/ng√†y
        - Fluoxetine 20-60 mg/ng√†y
        - T√°c d·ª•ng: 2-4 tu·∫ßn
        - ƒêi·ªÅu tr·ªã: 6-12 th√°ng (ƒë·ª£t ƒë·∫ßu), 1-2 nƒÉm (t√°i ph√°t)
        
        **SNRI:**
        - Venlafaxine XR 75-225 mg/ng√†y
        - Duloxetine 30-60 mg/ng√†y
        
        **Bupropion:**
        - XL 150-300 mg/ng√†y
        - T·ªët cho m·ªát m·ªèi, tƒÉng c√¢n
        - Tr√°nh n·∫øu co gi·∫≠t
        
        **Mirtazapine:**
        - 15-45 mg tr∆∞·ªõc ng·ªß
        - T·ªët cho m·∫•t ng·ªß, m·∫•t c√¢n
        
        ### Ph·ªëi h·ª£p:
        - Tr·∫ßm c·∫£m trung b√¨nh n·∫∑ng tr·ªü l√™n: CBT + thu·ªëc
        - Hi·ªáu qu·∫£ cao h∆°n ƒëi·ªÅu tr·ªã ƒë∆°n ƒë·ªôc
        - Gi·∫£m t·ª∑ l·ªá t√°i ph√°t
        
        ### Kh√¥ng ƒë√°p ·ª©ng:
        - TƒÉng li·ªÅu
        - Chuy·ªÉn sang SSRI kh√°c
        - Ph·ªëi h·ª£p thu·ªëc
        - ECT (tr·∫ßm c·∫£m n·∫∑ng, kh√¥ng ƒë√°p ·ª©ng)
        """)
    
    with st.expander("üîÑ Theo D√µi ƒêi·ªÅu Tr·ªã"):
        st.markdown("""
        ### L·ªãch t√°i ƒë√°nh gi√° PHQ-9:
        
        **Giai ƒëo·∫°n c·∫•p (4-8 tu·∫ßn ƒë·∫ßu):**
        - M·ªói 1-2 tu·∫ßn
        - ƒê√°nh gi√° ƒë√°p ·ª©ng ƒëi·ªÅu tr·ªã
        - Theo d√µi t√°c d·ª•ng ph·ª•
        - ƒê√°nh gi√° nguy c∆° t·ª± t·ª≠
        
        **Giai ƒëo·∫°n duy tr√¨:**
        - M·ªói 1-2 th√°ng
        - ƒê√°nh gi√° tri·ªáu ch·ª©ng c√≤n s√≥t
        - ƒêi·ªÅu ch·ªânh ƒëi·ªÅu tr·ªã n·∫øu c·∫ßn
        
        **ƒê√°p ·ª©ng ƒëi·ªÅu tr·ªã:**
        - **Response:** Gi·∫£m ‚â• 50% ƒëi·ªÉm PHQ-9
        - **Remission:** PHQ-9 < 5
        - **M·ª•c ti√™u:** Remission ho√†n to√†n
        
        **Khi d·ª´ng thu·ªëc:**
        - Ch·ªâ sau remission ‚â• 6-12 th√°ng
        - Gi·∫£m li·ªÅu d·∫ßn trong 4-6 tu·∫ßn
        - Theo d√µi s√°t tri·ªáu ch·ª©ng t√°i ph√°t
        - PHQ-9 ƒë·ªãnh k·ª≥ m·ªói th√°ng √ó 3 th√°ng
        """)
    
    with st.expander("‚ö†Ô∏è ƒê√°nh Gi√° Nguy C∆° T·ª± T·ª≠ Chi Ti·∫øt"):
        st.markdown("""
        ### Y·∫øu t·ªë nguy c∆° cao:
        
        **Y·∫øu t·ªë nguy c∆° ch√≠nh:**
        - C√≥ k·∫ø ho·∫°ch t·ª± t·ª≠ c·ª• th·ªÉ
        - C√≥ ph∆∞∆°ng ti·ªán (thu·ªëc, v≈© kh√≠)
        - Ti·ªÅn s·ª≠ t·ª± t·ª≠ tr∆∞·ªõc ƒë√¢y
        - Nam gi·ªõi, tu·ªïi cao
        - S·ªëng m·ªôt m√¨nh, c√¥ l·∫≠p
        - L·∫°m d·ª•ng ch·∫•t
        - B·ªánh c∆° th·ªÉ m√£n t√≠nh
        - M·∫•t m√°t g·∫ßn ƒë√¢y
        
        **C√¢u h·ªèi s√†ng l·ªçc:**
        1. "B·∫°n c√≥ nghƒ© r·∫±ng cu·ªôc s·ªëng kh√¥ng ƒë√°ng s·ªëng kh√¥ng?"
        2. "B·∫°n c√≥ nghƒ© v·ªÅ c√°i ch·∫øt ho·∫∑c ch·∫øt ƒëi kh√¥ng?"
        3. "B·∫°n c√≥ nghƒ© v·ªÅ vi·ªác t·ª± l√†m h·∫°i b·∫£n th√¢n kh√¥ng?"
        4. "B·∫°n c√≥ k·∫ø ho·∫°ch c·ª• th·ªÉ kh√¥ng?"
        5. "B·∫°n c√≥ ph∆∞∆°ng ti·ªán th·ª±c hi·ªán kh√¥ng?"
        6. "B·∫°n c√≥ √Ω ƒë·ªãnh th·ª±c hi·ªán kh√¥ng?"
        
        **ƒê√°nh gi√° chi ti·∫øt n·∫øu (+):**
        - **I**deation: √ù t∆∞·ªüng
        - **P**lan: K·∫ø ho·∫°ch
        - **M**eans: Ph∆∞∆°ng ti·ªán
        - **I**ntent: √ù ƒë·ªãnh
        
        **Can thi·ªáp:**
        - Nguy c∆° th·∫•p: Theo d√µi s√°t, tƒÉng h·ªó tr·ª£
        - Nguy c∆° trung b√¨nh: H·ªôi ch·∫©n t√¢m th·∫ßn kh·∫©n
        - Nguy c∆° cao: Nh·∫≠p vi·ªán t√¢m th·∫ßn
        - Nguy c∆° c·∫•p t√≠nh: C·∫•p c·ª©u ngay
        
        **An to√†n m√¥i tr∆∞·ªùng:**
        - Lo·∫°i b·ªè ph∆∞∆°ng ti·ªán t·ª± t·ª≠
        - Kh√¥ng ƒë·ªÉ b·ªánh nh√¢n m·ªôt m√¨nh
        - Th√¥ng b√°o gia ƒë√¨nh
        - L·∫≠p k·∫ø ho·∫°ch an to√†n (safety plan)
        """)
    
    with st.expander("üéØ PHQ-9 vs C√¥ng C·ª• Kh√°c"):
        st.markdown("""
        ### So s√°nh v·ªõi c√°c c√¥ng c·ª• s√†ng l·ªçc kh√°c:
        
        **PHQ-9:**
        - ‚úÖ Ng·∫Øn g·ªçn (9 c√¢u)
        - ‚úÖ D·ªÖ t√≠nh ƒëi·ªÉm
        - ‚úÖ D·ª±a tr√™n DSM-5
        - ‚úÖ ƒê√°nh gi√° m·ª©c ƒë·ªô n·∫∑ng
        - ‚úÖ Theo d√µi ƒëi·ªÅu tr·ªã
        - ‚ùå Kh√¥ng ƒë√°nh gi√° lo √¢u
        
        **PHQ-2 (Si√™u ng·∫Øn):**
        - Ch·ªâ 2 c√¢u (c√¢u 1 + 2 c·ªßa PHQ-9)
        - Screening nhanh
        - N·∫øu (+) ‚Üí L√†m PHQ-9 ƒë·∫ßy ƒë·ªß
        
        **GAD-7 (Lo √¢u):**
        - 7 c√¢u ƒë√°nh gi√° lo √¢u
        - Th∆∞·ªùng l√†m c√πng PHQ-9
        - Nhi·ªÅu BN c√≥ c·∫£ tr·∫ßm c·∫£m + lo √¢u
        
        **BDI-II (Beck Depression Inventory):**
        - 21 c√¢u h·ªèi
        - D√†i h∆°n, chi ti·∫øt h∆°n
        - √çt d√πng trong primary care
        
        **MADRS (Montgomery-√Ösberg):**
        - ƒê√°nh gi√° b·ªüi clinician
        - D√πng trong nghi√™n c·ª©u
        - Nh·∫°y c·∫£m v·ªõi thay ƒë·ªïi
        
        **HAM-D (Hamilton Depression Scale):**
        - ƒê√°nh gi√° b·ªüi clinician
        - 17-21 items
        - Gold standard trong nghi√™n c·ª©u
        - M·∫•t th·ªùi gian
        """)
    
    # References
    st.markdown("---")
    st.caption("""
    **T√†i li·ªáu tham kh·∫£o:**
    - Kroenke K, et al. The PHQ-9: validity of a brief depression severity measure. J Gen Intern Med. 2001
    - Spitzer RL, et al. Validation and utility of a self-report version of PRIME-MD. JAMA. 1999
    - American Psychiatric Association. DSM-5 Diagnostic Criteria for Major Depressive Disorder. 2013
    - NICE Guidelines: Depression in adults: treatment and management. 2022
    """)


if __name__ == "__main__":
    render()

