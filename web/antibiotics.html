<script>
registerModule({
  id:'abx',
  title:'Antibiotics',
  mount(root){
    const q = el('input',{placeholder:'Search drug/indication'});
    const list = el('div',{class:'list'});
    const wrap = el('div',{}, el('div',{class:'card'},
      el('div',{class:'input'}, el('label',{},'Query'), q),
      el('button',{class:'btn', onclick:()=>{
        google.script.run.withSuccessHandler(rows=>{
          list.innerHTML='';
          rows.forEach(r=>{
            list.append(el('div',{class:'card'},
              el('div',{}, el('b',{}, r.drug || '')),
              el('div',{}, r.indication || ''),
              el('div',{class:'small'}, (r.adult_dose||'') + ' â€” ' + (r.route||'')),
              el('div',{class:'small'}, 'Refs: ' + (r.refs||''))
            ));
          });
        }).api_abx_search(q.value);
      }}, 'Search')),
      list);
    root.append(wrap);
  }
});
</script>
